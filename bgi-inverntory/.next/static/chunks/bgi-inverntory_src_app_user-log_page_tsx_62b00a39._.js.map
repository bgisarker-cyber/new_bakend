{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Bgi-terminal-management/bgi-inverntory/src/app/user-log/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nexport default function UserLogsPage() {\r\n  const [logs, setLogs] = useState<any[]>([]);\r\n  const [filteredLogs, setFilteredLogs] = useState<any[]>([]);\r\n  const [error, setError] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Filters\r\n  const [emailFilter, setEmailFilter] = useState(\"\");\r\n  const [actionFilter, setActionFilter] = useState(\"\");\r\n  const [dateFilter, setDateFilter] = useState(\"\");\r\n  const [roleFilter, setRoleFilter] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const fetchLogs = async () => {\r\n      try {\r\n        const token = localStorage.getItem(\"access_token\");\r\n        const res = await fetch(\"http://127.0.0.1:8000/logs/show\", {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        const data = await res.json();\r\n        if (!res.ok) throw new Error(data.detail || \"Failed to fetch logs\");\r\n        setLogs(data.data);\r\n        setFilteredLogs(data.data);\r\n      } catch (err: any) {\r\n        setError(err.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchLogs();\r\n  }, []);\r\n\r\n  // Apply filters dynamically\r\n  useEffect(() => {\r\n    let filtered = logs;\r\n\r\n    if (emailFilter)\r\n      filtered = filtered.filter((log) =>\r\n        log.user_email?.toLowerCase().includes(emailFilter.toLowerCase())\r\n      );\r\n\r\n    if (actionFilter)\r\n      filtered = filtered.filter((log) =>\r\n        log.action?.toLowerCase().includes(actionFilter.toLowerCase())\r\n      );\r\n\r\n    if (roleFilter)\r\n      filtered = filtered.filter((log) =>\r\n        log.user_role?.toLowerCase().includes(roleFilter.toLowerCase())\r\n      );\r\n\r\n    if (dateFilter)\r\n      filtered = filtered.filter(\r\n        (log) =>\r\n          new Date(log.timestamp).toLocaleDateString() ===\r\n          new Date(dateFilter).toLocaleDateString()\r\n      );\r\n\r\n    setFilteredLogs(filtered);\r\n  }, [emailFilter, actionFilter, roleFilter, dateFilter, logs]);\r\n\r\n  if (loading) return <p className=\"p-6 text-gray-600\">Loading logs...</p>;\r\n  if (error) return <p className=\"p-6 text-red-500\">{error}</p>;\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h1 className=\"text-2xl font-bold mb-6\">User Activity Logs</h1>\r\n\r\n      {/* Filters */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Filter by Gmail\"\r\n          value={emailFilter}\r\n          onChange={(e) => setEmailFilter(e.target.value)}\r\n          className=\"border p-2 rounded-lg w-full focus:ring focus:ring-blue-200 outline-none\"\r\n        />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Filter by Action\"\r\n          value={actionFilter}\r\n          onChange={(e) => setActionFilter(e.target.value)}\r\n          className=\"border p-2 rounded-lg w-full focus:ring focus:ring-blue-200 outline-none\"\r\n        />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Filter by Role\"\r\n          value={roleFilter}\r\n          onChange={(e) => setRoleFilter(e.target.value)}\r\n          className=\"border p-2 rounded-lg w-full focus:ring focus:ring-blue-200 outline-none\"\r\n        />\r\n        <input\r\n          type=\"date\"\r\n          value={dateFilter}\r\n          onChange={(e) => setDateFilter(e.target.value)}\r\n          className=\"border p-2 rounded-lg w-full focus:ring focus:ring-blue-200 outline-none\"\r\n        />\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"overflow-x-auto rounded-lg shadow\">\r\n        <table className=\"w-full border-collapse border border-gray-300\">\r\n          <thead className=\"bg-blue-50 text-gray-700\">\r\n            <tr>\r\n              <th className=\"border p-2\">User Email</th>\r\n              <th className=\"border p-2\">Role</th>\r\n              <th className=\"border p-2\">Action</th>\r\n              <th className=\"border p-2\">Description</th>\r\n              <th className=\"border p-2\">Timestamp</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredLogs.length > 0 ? (\r\n              filteredLogs.map((log) => (\r\n                <tr\r\n                  key={log.id}\r\n                  className=\"hover:bg-gray-50 transition-colors\"\r\n                >\r\n                  <td className=\"border p-2\">{log.user_email}</td>\r\n                  <td className=\"border p-2\">{log.user_role}</td>\r\n                  <td className=\"border p-2 font-semibold text-blue-600\">\r\n                    {log.action}\r\n                  </td>\r\n                  <td className=\"border p-2\">{log.description || \"-\"}</td>\r\n                  <td className=\"border p-2\">\r\n                    {new Date(log.timestamp).toLocaleString()}\r\n                  </td>\r\n                </tr>\r\n              ))\r\n            ) : (\r\n              <tr>\r\n                <td\r\n                  colSpan={5}\r\n                  className=\"text-center text-gray-500 p-4 italic\"\r\n                >\r\n                  No logs found matching your filters.\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}