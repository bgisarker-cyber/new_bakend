{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Bgi-terminal-management/bgi-inverntory/src/app/task-manager/my-task/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useQuery, useMutation, useQueryClient, QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\r\nimport axios from \"axios\";\r\nimport {\r\n  Container,\r\n  Typography,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  CardActions,\r\n  Chip,\r\n  IconButton,\r\n  Stack,\r\n  Button,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  TextField,\r\n  MenuItem,\r\n  CircularProgress,\r\n  Toolbar,\r\n  Tooltip,\r\n} from \"@mui/material\";\r\nimport { Refresh as RefreshIcon, Edit as EditIcon } from \"@mui/icons-material\";\r\nimport { useState } from \"react\";\r\n\r\n/* ---------- axios ---------- */\r\naxios.defaults.baseURL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8000\";\r\naxios.interceptors.request.use((cfg) => {\r\n  const t = localStorage.getItem(\"access_token\");\r\n  if (t) cfg.headers.Authorization = `Bearer ${t}`;\r\n  return cfg;\r\n});\r\n\r\n/* ---------- types ---------- */\r\ntype Task = {\r\n  id: number;\r\n  title: string;\r\n  merchant_name: string;\r\n  merchant_phone: string;\r\n  location: string;\r\n  problem_type: string;\r\n  problem_details: string;\r\n  instructions: string;\r\n  priority: \"low\" | \"medium\" | \"high\";\r\n  status: \"open\" | \"in_progress\" | \"completed\";\r\n  create_time: string;\r\n};\r\n\r\n/* ---------- react-query ---------- */\r\nconst queryClient = new QueryClient();\r\n\r\n/* ---------- main component ---------- */\r\nfunction MyTasksGrid() {\r\n  const [open, setOpen] = useState(false);\r\n  const [selected, setSelected] = useState<Task | null>(null);\r\n  const [status, setStatus] = useState<\"open\" | \"in_progress\" | \"completed\">(\"open\");\r\n  const [note, setNote] = useState(\"\");\r\n\r\n  const { data = [], isLoading, refetch } = useQuery<Task[]>({\r\n    queryKey: [\"my-tasks\"],\r\n    queryFn: () => axios.get(\"/tasks/my\").then((r) => r.data),\r\n  });\r\n\r\n  const mutate = useMutation({\r\n    mutationFn: () =>\r\n      axios.put(`/tasks/my/${selected!.id}/status`, {\r\n        status_val: status,\r\n        note,\r\n      }),\r\n    onSuccess: () => {\r\n      setOpen(false);\r\n      queryClient.invalidateQueries({ queryKey: [\"my-tasks\"] });\r\n    },\r\n  });\r\n\r\n  const chipColor = (s: Task[\"status\"]) =>\r\n    s === \"completed\" ? \"success\" : s === \"in_progress\" ? \"info\" : \"default\";\r\n\r\n  const priorityColor = (p: Task[\"priority\"]) =>\r\n    p === \"high\" ? \"error\" : p === \"medium\" ? \"warning\" : \"success\";\r\n\r\n  return (\r\n    <Container maxWidth=\"xl\" sx={{ py: 3 }}>\r\n      {/* ---------- top bar ---------- */}\r\n      <Toolbar disableGutters sx={{ mb: 3, justifyContent: \"space-between\" }}>\r\n        <Typography variant=\"h5\" fontWeight={600}>\r\n          My Tasks\r\n        </Typography>\r\n        <Tooltip title=\"Refresh\">\r\n          <IconButton onClick={() => refetch()}>{isLoading ? <CircularProgress size={20} /> : <RefreshIcon />}</IconButton>\r\n        </Tooltip>\r\n      </Toolbar>\r\n\r\n      {/* ---------- cards grid ---------- */}\r\n      <Grid container spacing={3}>\r\n        {data.map((t) => (\r\n          <Grid item xs={12} sm={6} md={4} lg={3} key={t.id}>\r\n            <Card sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\" }}>\r\n              <CardContent sx={{ flexGrow: 1 }}>\r\n                <Stack spacing={1}>\r\n                  <Typography variant=\"h6\" noWrap title={t.title}>\r\n                    {t.title}\r\n                  </Typography>\r\n\r\n                  <Stack direction=\"row\" spacing={1} alignItems=\"center\">\r\n                    <Chip label={t.status} color={chipColor(t.status)} size=\"small\" />\r\n                    <Chip label={t.priority} color={priorityColor(t.priority)} size=\"small\" />\r\n                  </Stack>\r\n\r\n                  <Typography variant=\"body2\" color=\"text.secondary\">\r\n                    <strong>Merchant:</strong> {t.merchant_name}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\" color=\"text.secondary\">\r\n                    <strong>Contact:</strong> {t.merchant_phone}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\" color=\"text.secondary\">\r\n                    <strong>Location:</strong> {t.location}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\" color=\"text.secondary\">\r\n                    <strong>Problem:</strong> {t.problem_type}\r\n                  </Typography>\r\n                  \r\n                  <Typography variant=\"body2\" color=\"text.secondary\">\r\n                    <strong>Detaitls</strong> {t.problem_details}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\" color=\"text.secondary\">\r\n                    <strong>Instructions</strong> {t.instructions}\r\n                  </Typography>\r\n\r\n                  <Typography variant=\"caption\" color=\"text.secondary\">\r\n                    Created: {new Date(t.create_time).toLocaleString()}\r\n                  </Typography>\r\n                </Stack>\r\n              </CardContent>\r\n\r\n              <CardActions sx={{ justifyContent: \"flex-end\" }}>\r\n                <Button\r\n                  size=\"small\"\r\n                  variant=\"outlined\"\r\n                  startIcon={<EditIcon />}\r\n                  onClick={() => {\r\n                    setSelected(t);\r\n                    setStatus(t.status);\r\n                    setNote(\"\");\r\n                    setOpen(true);\r\n                  }}\r\n                >\r\n                  Update\r\n                </Button>\r\n              </CardActions>\r\n            </Card>\r\n          </Grid>\r\n        ))}\r\n      </Grid>\r\n\r\n      {/* ---------- empty state ---------- */}\r\n      {!isLoading && data.length === 0 && (\r\n        <Typography variant=\"h6\" color=\"text.secondary\" align=\"center\" sx={{ mt: 8 }}>\r\n          No tasks assigned to you ðŸŽ‰\r\n        </Typography>\r\n      )}\r\n\r\n      {/* ---------- update dialog ---------- */}\r\n      <Dialog open={open} onClose={() => setOpen(false)} maxWidth=\"sm\" fullWidth>\r\n        <DialogTitle>Update Task #{selected?.id}</DialogTitle>\r\n        <DialogContent>\r\n          <Stack spacing={2} mt={1}>\r\n            <TextField select label=\"Status\" value={status} onChange={(e) => setStatus(e.target.value as any)} fullWidth>\r\n              <MenuItem value=\"open\">Open</MenuItem>\r\n              <MenuItem value=\"in_progress\">In Progress</MenuItem>\r\n              <MenuItem value=\"completed\">Completed</MenuItem>\r\n            </TextField>\r\n            <TextField\r\n              label=\"Note (optional)\"\r\n              multiline\r\n              rows={3}\r\n              value={note}\r\n              onChange={(e) => setNote(e.target.value)}\r\n              fullWidth\r\n            />\r\n          </Stack>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setOpen(false)}>Cancel</Button>\r\n          <Button\r\n            onClick={() => mutate.mutate()}\r\n            disabled={mutate.isPending}\r\n            variant=\"contained\"\r\n          >\r\n            {mutate.isPending ? <CircularProgress size={20} /> : \"Save\"}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default function MyTasksPage() {\r\n  return (\r\n    <QueryClientProvider client={queryClient}>\r\n      <MyTasksGrid />\r\n    </QueryClientProvider>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}