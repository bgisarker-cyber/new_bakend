{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///D:/Bgi-terminal-management/bgi-inverntory/src/app/task-manager/page.tsx"],"sourcesContent":["// src/App.tsx\r\nimport { useEffect, useState } from \"react\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport axios from \"axios\";\r\nimport {\r\n  Container,\r\n  Typography,\r\n  TextField,\r\n  MenuItem,\r\n  Button,\r\n  Stack,\r\n  Alert,\r\n  CircularProgress,\r\n  Autocomplete,\r\n} from \"@mui/material\";\r\n\r\naxios.defaults.baseURL = import.meta.env.VITE_API_URL || \"http://localhost:8000\";\r\n\r\ntype User = { id: number; username: string; role: string };\r\n\r\ntype FormInputs = {\r\n  title: string;\r\n  merchant_name: string;\r\n  merchant_phone: string;\r\n  bank: string;\r\n  location: string;\r\n  problem_type: string;\r\n  problem_details: string;\r\n  instructions: string;\r\n  task_type: \"install\" | \"repair\" | \"maintenance\";\r\n  assigned_to: number | null;\r\n  priority: \"low\" | \"medium\" | \"high\";\r\n};\r\n\r\nconst problemChoices = [\r\n  \"Battery down\",\r\n  \"Payment not working\",\r\n  \"Network off\",\r\n  \"Display not responsive\",\r\n  \"App change required\",\r\n  \"Firmware change\",\r\n  \"Other\",\r\n];\r\n\r\nfunction App() {\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [msg, setMsg] = useState<{ type: \"success\" | \"error\"; text: string } | null>(null);\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    control,\r\n    reset,\r\n    formState: { errors },\r\n  } = useForm<FormInputs>({\r\n    defaultValues: {\r\n      priority: \"medium\",\r\n      task_type: \"repair\",\r\n      problem_type: \"Other\",\r\n    },\r\n  });\r\n\r\n  /* fetch admin + support users */\r\n  useEffect(() => {\r\n    axios\r\n      .get<User[]>(\"/users?role=support,admin\")\r\n      .then((r) => setUsers(r.data))\r\n      .catch(() => setMsg({ type: \"error\", text: \"Failed to load users\" }));\r\n  }, []);\r\n\r\n  const onSubmit = async (data: FormInputs) => {\r\n    if (!data.assigned_to) {\r\n      setMsg({ type: \"error\", text: \"Please select an assignee\" });\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    setMsg(null);\r\n\r\n    /* who is creating this call?  (store userId in localStorage after login) */\r\n    const assignedBy = Number(localStorage.getItem(\"userId\") || 1); // fallback 1\r\n\r\n    try {\r\n      await axios.post(\"/tasks/create\", { ...data, assigned_to: data.assigned_to, assigned_by: assignedBy });\r\n      setMsg({ type: \"success\", text: \"Call assigned successfully\" });\r\n      reset();\r\n    } catch (e: any) {\r\n      const detail = e?.response?.data?.detail || \"Network error\";\r\n      setMsg({ type: \"error\", text: detail });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container maxWidth=\"md\" sx={{ py: 4 }}>\r\n      <Typography variant=\"h4\" gutterBottom>\r\n        Create & Assign Call\r\n      </Typography>\r\n\r\n      {msg && <Alert severity={msg.type} sx={{ mb: 2 }}>{msg.text}</Alert>}\r\n\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n        <Stack spacing={2}>\r\n          <TextField\r\n            label=\"Title\"\r\n            fullWidth\r\n            {...register(\"title\", { required: \"Required\" })}\r\n            error={!!errors.title}\r\n            helperText={errors.title?.message}\r\n          />\r\n\r\n          <TextField\r\n            label=\"Merchant Name\"\r\n            fullWidth\r\n            {...register(\"merchant_name\", { required: \"Required\" })}\r\n            error={!!errors.merchant_name}\r\n            helperText={errors.merchant_name?.message}\r\n          />\r\n\r\n          <TextField\r\n            label=\"Merchant Phone\"\r\n            fullWidth\r\n            {...register(\"merchant_phone\", { required: \"Required\" })}\r\n            error={!!errors.merchant_phone}\r\n            helperText={errors.merchant_phone?.message}\r\n          />\r\n\r\n          <TextField label=\"Bank\" fullWidth {...register(\"bank\")} />\r\n\r\n          <TextField\r\n            label=\"Location\"\r\n            fullWidth\r\n            {...register(\"location\", { required: \"Required\" })}\r\n            error={!!errors.location}\r\n            helperText={errors.location?.message}\r\n          />\r\n\r\n          <TextField\r\n            select\r\n            label=\"Problem Type\"\r\n            fullWidth\r\n            {...register(\"problem_type\")}\r\n          >\r\n            {problemChoices.map((p) => (\r\n              <MenuItem key={p} value={p}>\r\n                {p}\r\n              </MenuItem>\r\n            ))}\r\n          </TextField>\r\n\r\n          <TextField\r\n            label=\"Problem Details\"\r\n            fullWidth\r\n            multiline\r\n            rows={3}\r\n            {...register(\"problem_details\")}\r\n          />\r\n\r\n          <TextField\r\n            label=\"Instructions\"\r\n            fullWidth\r\n            multiline\r\n            rows={3}\r\n            {...register(\"instructions\")}\r\n          />\r\n\r\n          <TextField\r\n            select\r\n            label=\"Task Type\"\r\n            fullWidth\r\n            {...register(\"task_type\")}\r\n          >\r\n            <MenuItem value=\"install\">Install</MenuItem>\r\n            <MenuItem value=\"repair\">Repair</MenuItem>\r\n            <MenuItem value=\"maintenance\">Maintenance</MenuItem>\r\n          </TextField>\r\n\r\n          <TextField\r\n            select\r\n            label=\"Priority\"\r\n            fullWidth\r\n            {...register(\"priority\")}\r\n          >\r\n            <MenuItem value=\"low\">Low</MenuItem>\r\n            <MenuItem value=\"medium\">Medium</MenuItem>\r\n            <MenuItem value=\"high\">High</MenuItem>\r\n          </TextField>\r\n\r\n          {/*  SEARCHABLE DROPDOWN  */}\r\n          <Controller\r\n            name=\"assigned_to\"\r\n            control={control}\r\n            render={({ field }) => (\r\n              <Autocomplete\r\n                options={users}\r\n                getOptionLabel={(u) => `${u.username} (${u.role})`}\r\n                isOptionEqualToValue={(opt, val) => opt.id === val.id}\r\n                onChange={(_, newValue) => field.onChange(newValue?.id ?? null)}\r\n                value={users.find((u) => u.id === field.value) || null}\r\n                renderInput={(params) => (\r\n                  <TextField\r\n                    {...params}\r\n                    label=\"Assign To\"\r\n                    error={!!errors.assigned_to}\r\n                    helperText={errors.assigned_to ? \"Required\" : \"\"}\r\n                  />\r\n                )}\r\n              />\r\n            )}\r\n          />\r\n\r\n          <Button\r\n            type=\"submit\"\r\n            variant=\"contained\"\r\n            size=\"large\"\r\n            disabled={loading}\r\n            startIcon={loading ? <CircularProgress size={20} /> : null}\r\n          >\r\n            Create & Assign Call\r\n          </Button>\r\n        </Stack>\r\n      </form>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default App;"],"names":[],"mappings":"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","debugId":null}}]
}