{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Bgi-terminal-management/bgi-inverntory/src/app/user-log/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nexport default function UserLogsPage() {\r\n  const [logs, setLogs] = useState<any[]>([]);\r\n  const [filteredLogs, setFilteredLogs] = useState<any[]>([]);\r\n  const [error, setError] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Filters\r\n  const [emailFilter, setEmailFilter] = useState(\"\");\r\n  const [actionFilter, setActionFilter] = useState(\"\");\r\n  const [dateFilter, setDateFilter] = useState(\"\");\r\n  const [roleFilter, setRoleFilter] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const fetchLogs = async () => {\r\n      try {\r\n        const token = localStorage.getItem(\"access_token\");\r\n        const res = await fetch(\"http://127.0.0.1:8000/logs/show\", {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        const data = await res.json();\r\n        if (!res.ok) throw new Error(data.detail || \"Failed to fetch logs\");\r\n        setLogs(data.data);\r\n        setFilteredLogs(data.data);\r\n      } catch (err: any) {\r\n        setError(err.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchLogs();\r\n  }, []);\r\n\r\n  // Apply filters dynamically\r\n  useEffect(() => {\r\n    let filtered = logs;\r\n\r\n    if (emailFilter)\r\n      filtered = filtered.filter((log) =>\r\n        log.user_email?.toLowerCase().includes(emailFilter.toLowerCase())\r\n      );\r\n\r\n    if (actionFilter)\r\n      filtered = filtered.filter((log) =>\r\n        log.action?.toLowerCase().includes(actionFilter.toLowerCase())\r\n      );\r\n\r\n    if (roleFilter)\r\n      filtered = filtered.filter((log) =>\r\n        log.user_role?.toLowerCase().includes(roleFilter.toLowerCase())\r\n      );\r\n\r\n    if (dateFilter)\r\n      filtered = filtered.filter(\r\n        (log) =>\r\n          new Date(log.timestamp).toLocaleDateString() ===\r\n          new Date(dateFilter).toLocaleDateString()\r\n      );\r\n\r\n    setFilteredLogs(filtered);\r\n  }, [emailFilter, actionFilter, roleFilter, dateFilter, logs]);\r\n\r\n  if (loading) return <p className=\"p-6 text-gray-600\">Loading logs...</p>;\r\n  if (error) return <p className=\"p-6 text-red-500\">{error}</p>;\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h1 className=\"text-2xl font-bold mb-6\">User Activity Logs</h1>\r\n\r\n      {/* Filters */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Filter by Gmail\"\r\n          value={emailFilter}\r\n          onChange={(e) => setEmailFilter(e.target.value)}\r\n          className=\"border p-2 rounded-lg w-full focus:ring focus:ring-blue-200 outline-none\"\r\n        />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Filter by Action\"\r\n          value={actionFilter}\r\n          onChange={(e) => setActionFilter(e.target.value)}\r\n          className=\"border p-2 rounded-lg w-full focus:ring focus:ring-blue-200 outline-none\"\r\n        />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Filter by Role\"\r\n          value={roleFilter}\r\n          onChange={(e) => setRoleFilter(e.target.value)}\r\n          className=\"border p-2 rounded-lg w-full focus:ring focus:ring-blue-200 outline-none\"\r\n        />\r\n        <input\r\n          type=\"date\"\r\n          value={dateFilter}\r\n          onChange={(e) => setDateFilter(e.target.value)}\r\n          className=\"border p-2 rounded-lg w-full focus:ring focus:ring-blue-200 outline-none\"\r\n        />\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"overflow-x-auto rounded-lg shadow\">\r\n        <table className=\"w-full border-collapse border border-gray-300\">\r\n          <thead className=\"bg-blue-50 text-gray-700\">\r\n            <tr>\r\n              <th className=\"border p-2\">User Email</th>\r\n              <th className=\"border p-2\">Role</th>\r\n              <th className=\"border p-2\">Action</th>\r\n              <th className=\"border p-2\">Description</th>\r\n              <th className=\"border p-2\">Timestamp</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredLogs.length > 0 ? (\r\n              filteredLogs.map((log) => (\r\n                <tr\r\n                  key={log.id}\r\n                  className=\"hover:bg-gray-50 transition-colors\"\r\n                >\r\n                  <td className=\"border p-2\">{log.user_email}</td>\r\n                  <td className=\"border p-2\">{log.user_role}</td>\r\n                  <td className=\"border p-2 font-semibold text-blue-600\">\r\n                    {log.action}\r\n                  </td>\r\n                  <td className=\"border p-2\">{log.description || \"-\"}</td>\r\n                  <td className=\"border p-2\">\r\n                    {new Date(log.timestamp).toLocaleString()}\r\n                  </td>\r\n                </tr>\r\n              ))\r\n            ) : (\r\n              <tr>\r\n                <td\r\n                  colSpan={5}\r\n                  className=\"text-center text-gray-500 p-4 italic\"\r\n                >\r\n                  No logs found matching your filters.\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}